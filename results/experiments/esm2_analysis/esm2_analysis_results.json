{
  "timestamp": "2026-02-01T00:38:25.295443",
  "description": "ESM-2 protein embedding analysis for NEST-DRUG",
  "note": "Addresses reviewer critique E5: protein language model embeddings as L1",
  "config": {
    "esm_model": "esm2_t33_650M_UR50D",
    "checkpoint": "results/v3/best_model.pt",
    "n_targets": 10,
    "targets": [
      "egfr",
      "drd2",
      "adrb2",
      "bace1",
      "esr1",
      "hdac2",
      "jak2",
      "pparg",
      "cyp3a4",
      "fxa"
    ]
  },
  "sequences": {
    "egfr": {
      "accession": "P00533",
      "length": 1210
    },
    "drd2": {
      "accession": "P14416",
      "length": 443
    },
    "adrb2": {
      "accession": "P07550",
      "length": 413
    },
    "bace1": {
      "accession": "P56817",
      "length": 501
    },
    "esr1": {
      "accession": "P03372",
      "length": 595
    },
    "hdac2": {
      "accession": "Q92769",
      "length": 488
    },
    "jak2": {
      "accession": "O60674",
      "length": 1132
    },
    "pparg": {
      "accession": "P37231",
      "length": 505
    },
    "cyp3a4": {
      "accession": "P08684",
      "length": 503
    },
    "fxa": {
      "accession": "P00742",
      "length": 488
    }
  },
  "similarity_correlation": {
    "pearson_r": 0.10643636661264046,
    "pearson_p": 0.4865005294420444,
    "spearman_rho": 0.1555994729907773,
    "spearman_p": 0.3074185177970705,
    "esm_similarities": {
      "egfr-drd2": 0.7888033390045166,
      "egfr-adrb2": 0.7758386731147766,
      "egfr-bace1": 0.896173894405365,
      "egfr-esr1": 0.8012742400169373,
      "egfr-hdac2": 0.8016285300254822,
      "egfr-jak2": 0.7742921710014343,
      "egfr-pparg": 0.7674105763435364,
      "egfr-cyp3a4": 0.8545843958854675,
      "egfr-fxa": 0.8124794363975525,
      "drd2-adrb2": 0.9849249124526978,
      "drd2-bace1": 0.8005979061126709,
      "drd2-esr1": 0.9534735083580017,
      "drd2-hdac2": 0.9353561997413635,
      "drd2-jak2": 0.9565597176551819,
      "drd2-pparg": 0.957406222820282,
      "drd2-cyp3a4": 0.8811244368553162,
      "drd2-fxa": 0.9494379162788391,
      "adrb2-bace1": 0.7935898303985596,
      "adrb2-esr1": 0.9333623051643372,
      "adrb2-hdac2": 0.9187869429588318,
      "adrb2-jak2": 0.9459143280982971,
      "adrb2-pparg": 0.9397825002670288,
      "adrb2-cyp3a4": 0.8856065273284912,
      "adrb2-fxa": 0.9405233263969421,
      "bace1-esr1": 0.8237220644950867,
      "bace1-hdac2": 0.7825206518173218,
      "bace1-jak2": 0.7777799367904663,
      "bace1-pparg": 0.7794014811515808,
      "bace1-cyp3a4": 0.8165819048881531,
      "bace1-fxa": 0.8120396137237549,
      "esr1-hdac2": 0.9474155902862549,
      "esr1-jak2": 0.9650497436523438,
      "esr1-pparg": 0.9835121035575867,
      "esr1-cyp3a4": 0.8478835225105286,
      "esr1-fxa": 0.9504083395004272,
      "hdac2-jak2": 0.9695395231246948,
      "hdac2-pparg": 0.9648882150650024,
      "hdac2-cyp3a4": 0.8772792220115662,
      "hdac2-fxa": 0.9585798978805542,
      "jak2-pparg": 0.9823476672172546,
      "jak2-cyp3a4": 0.8718817830085754,
      "jak2-fxa": 0.9648293256759644,
      "pparg-cyp3a4": 0.8620681166648865,
      "pparg-fxa": 0.9605613946914673,
      "cyp3a4-fxa": 0.8846098184585571
    },
    "l1_similarities": {
      "egfr-drd2": 0.1198793351650238,
      "egfr-adrb2": 0.07625626027584076,
      "egfr-bace1": -0.014504997991025448,
      "egfr-esr1": 0.10516758263111115,
      "egfr-hdac2": -0.10428326576948166,
      "egfr-jak2": -0.09197969734668732,
      "egfr-pparg": -0.06061658263206482,
      "egfr-cyp3a4": -0.11849574744701385,
      "egfr-fxa": 0.17181603610515594,
      "drd2-adrb2": -0.17422161996364594,
      "drd2-bace1": -0.2517361342906952,
      "drd2-esr1": 0.013546246103942394,
      "drd2-hdac2": 0.0947503000497818,
      "drd2-jak2": 0.10577239096164703,
      "drd2-pparg": 0.21435970067977905,
      "drd2-cyp3a4": -0.1942211389541626,
      "drd2-fxa": -0.06367351859807968,
      "adrb2-bace1": -0.1313314437866211,
      "adrb2-esr1": 0.00843774527311325,
      "adrb2-hdac2": 0.13114601373672485,
      "adrb2-jak2": 0.20598778128623962,
      "adrb2-pparg": 0.15409637987613678,
      "adrb2-cyp3a4": -0.05250559747219086,
      "adrb2-fxa": 0.017315400764346123,
      "bace1-esr1": 0.07330730557441711,
      "bace1-hdac2": -0.03595855087041855,
      "bace1-jak2": -0.16040734946727753,
      "bace1-pparg": -0.09098394215106964,
      "bace1-cyp3a4": 0.3985772728919983,
      "bace1-fxa": 0.14780592918395996,
      "esr1-hdac2": -0.08507612347602844,
      "esr1-jak2": -0.07394514977931976,
      "esr1-pparg": 0.015968021005392075,
      "esr1-cyp3a4": -0.0672592744231224,
      "esr1-fxa": 0.20295453071594238,
      "hdac2-jak2": 0.20961269736289978,
      "hdac2-pparg": -0.1492258608341217,
      "hdac2-cyp3a4": -0.061635568737983704,
      "hdac2-fxa": 0.18309634923934937,
      "jak2-pparg": -0.06529728323221207,
      "jak2-cyp3a4": -0.2278706580400467,
      "jak2-fxa": 0.15588600933551788,
      "pparg-cyp3a4": 0.10072705149650574,
      "pparg-fxa": -0.3134228587150574,
      "cyp3a4-fxa": -0.2503787577152252
    },
    "esm_sim_matrix": [
      [
        1.0000001192092896,
        0.7888033390045166,
        0.7758386731147766,
        0.896173894405365,
        0.8012742400169373,
        0.8016285300254822,
        0.7742921710014343,
        0.7674105763435364,
        0.8545843958854675,
        0.8124794363975525
      ],
      [
        0.7888033390045166,
        0.9999998211860657,
        0.9849249124526978,
        0.8005979061126709,
        0.9534735083580017,
        0.9353561997413635,
        0.9565597176551819,
        0.957406222820282,
        0.8811244368553162,
        0.9494379162788391
      ],
      [
        0.7758386731147766,
        0.9849249124526978,
        0.9999998211860657,
        0.7935898303985596,
        0.9333623051643372,
        0.9187869429588318,
        0.9459143280982971,
        0.9397825002670288,
        0.8856065273284912,
        0.9405233263969421
      ],
      [
        0.896173894405365,
        0.8005979061126709,
        0.7935898303985596,
        0.9999998211860657,
        0.8237220644950867,
        0.7825206518173218,
        0.7777799367904663,
        0.7794014811515808,
        0.8165819048881531,
        0.8120396137237549
      ],
      [
        0.8012742400169373,
        0.9534735083580017,
        0.9333623051643372,
        0.8237220644950867,
        0.9999999403953552,
        0.9474155902862549,
        0.9650497436523438,
        0.9835121035575867,
        0.8478835225105286,
        0.9504083395004272
      ],
      [
        0.8016285300254822,
        0.9353561997413635,
        0.9187869429588318,
        0.7825206518173218,
        0.9474155902862549,
        0.9999997615814209,
        0.9695395231246948,
        0.9648882150650024,
        0.8772792220115662,
        0.9585798978805542
      ],
      [
        0.7742921710014343,
        0.9565597176551819,
        0.9459143280982971,
        0.7777799367904663,
        0.9650497436523438,
        0.9695395231246948,
        1.0000001192092896,
        0.9823476672172546,
        0.8718817830085754,
        0.9648293256759644
      ],
      [
        0.7674105763435364,
        0.957406222820282,
        0.9397825002670288,
        0.7794014811515808,
        0.9835121035575867,
        0.9648882150650024,
        0.9823476672172546,
        1.0,
        0.8620681166648865,
        0.9605613946914673
      ],
      [
        0.8545843958854675,
        0.8811244368553162,
        0.8856065273284912,
        0.8165819048881531,
        0.8478835225105286,
        0.8772792220115662,
        0.8718817830085754,
        0.8620681166648865,
        0.9999998807907104,
        0.8846098184585571
      ],
      [
        0.8124794363975525,
        0.9494379162788391,
        0.9405233263969421,
        0.8120396137237549,
        0.9504083395004272,
        0.9585798978805542,
        0.9648293256759644,
        0.9605613946914673,
        0.8846098184585571,
        0.9999998807907104
      ]
    ],
    "l1_sim_matrix": [
      [
        1.0000001192092896,
        0.1198793351650238,
        0.07625626027584076,
        -0.014504997991025448,
        0.10516758263111115,
        -0.10428326576948166,
        -0.09197969734668732,
        -0.06061658263206482,
        -0.11849574744701385,
        0.17181603610515594
      ],
      [
        0.1198793351650238,
        1.0000001192092896,
        -0.17422161996364594,
        -0.2517361342906952,
        0.013546246103942394,
        0.0947503000497818,
        0.10577239096164703,
        0.21435970067977905,
        -0.1942211389541626,
        -0.06367351859807968
      ],
      [
        0.07625626027584076,
        -0.17422161996364594,
        1.0,
        -0.1313314437866211,
        0.00843774527311325,
        0.13114601373672485,
        0.20598778128623962,
        0.15409637987613678,
        -0.05250559747219086,
        0.017315400764346123
      ],
      [
        -0.014504997991025448,
        -0.2517361342906952,
        -0.1313314437866211,
        1.0,
        0.07330730557441711,
        -0.03595855087041855,
        -0.16040734946727753,
        -0.09098394215106964,
        0.3985772728919983,
        0.14780592918395996
      ],
      [
        0.10516758263111115,
        0.013546246103942394,
        0.00843774527311325,
        0.07330730557441711,
        1.0000001192092896,
        -0.08507612347602844,
        -0.07394514977931976,
        0.015968021005392075,
        -0.0672592744231224,
        0.20295453071594238
      ],
      [
        -0.10428326576948166,
        0.0947503000497818,
        0.13114601373672485,
        -0.03595855087041855,
        -0.08507612347602844,
        0.9999998807907104,
        0.20961269736289978,
        -0.1492258608341217,
        -0.061635568737983704,
        0.18309634923934937
      ],
      [
        -0.09197969734668732,
        0.10577239096164703,
        0.20598778128623962,
        -0.16040734946727753,
        -0.07394514977931976,
        0.20961269736289978,
        0.9999998807907104,
        -0.06529728323221207,
        -0.2278706580400467,
        0.15588600933551788
      ],
      [
        -0.06061658263206482,
        0.21435970067977905,
        0.15409637987613678,
        -0.09098394215106964,
        0.015968021005392075,
        -0.1492258608341217,
        -0.06529728323221207,
        1.0,
        0.10072705149650574,
        -0.3134228587150574
      ],
      [
        -0.11849574744701385,
        -0.1942211389541626,
        -0.05250559747219086,
        0.3985772728919983,
        -0.0672592744231224,
        -0.061635568737983704,
        -0.2278706580400467,
        0.10072705149650574,
        1.0,
        -0.2503787577152252
      ],
      [
        0.17181603610515594,
        -0.06367351859807968,
        0.017315400764346123,
        0.14780592918395996,
        0.20295453071594238,
        0.18309634923934937,
        0.15588600933551788,
        -0.3134228587150574,
        -0.2503787577152252,
        1.0
      ]
    ],
    "targets": [
      "egfr",
      "drd2",
      "adrb2",
      "bace1",
      "esr1",
      "hdac2",
      "jak2",
      "pparg",
      "cyp3a4",
      "fxa"
    ]
  },
  "zeroshot_evaluation": {
    "egfr": {
      "auc_generic": 0.8248439991230867,
      "auc_esm_nn": 0.7673191766217482,
      "auc_esm_weighted": 0.9508760877759669,
      "auc_correct": 0.9625725292648889,
      "nearest_esm_target": "bace1",
      "nearest_esm_similarity": 0.896173894405365,
      "predicted_l1_cosine_to_correct": 0.010639716871082783,
      "esm_weights": {
        "drd2": 0.10656670277546915,
        "adrb2": 0.10383901575723001,
        "bace1": 0.13209379217357112,
        "esr1": 0.10925809291531136,
        "hdac2": 0.10933553845159583,
        "jak2": 0.10351833742796411,
        "pparg": 0.10210335462644199,
        "cyp3a4": 0.12155091396646032,
        "fxa": 0.1117342519059561
      }
    },
    "drd2": {
      "auc_generic": 0.9042715419318312,
      "auc_esm_nn": 0.7860393604800434,
      "auc_esm_weighted": 0.9150702603042494,
      "auc_correct": 0.9857021674323617,
      "nearest_esm_target": "adrb2",
      "nearest_esm_similarity": 0.9849249124526978,
      "predicted_l1_cosine_to_correct": -0.07027322053909302,
      "esm_weights": {
        "egfr": 0.08608702862999197,
        "adrb2": 0.12743442164952484,
        "bace1": 0.0881418879951208,
        "esr1": 0.11966534845787824,
        "hdac2": 0.11540693722330557,
        "jak2": 0.12040625732733445,
        "pparg": 0.12061027902149626,
        "cyp3a4": 0.10354444502702774,
        "fxa": 0.11870339466832011
      }
    },
    "adrb2": {
      "auc_generic": 0.7096520229916916,
      "auc_esm_nn": 0.6255903187937794,
      "auc_esm_weighted": 0.7130434368164762,
      "auc_correct": 0.776390034587259,
      "nearest_esm_target": "drd2",
      "nearest_esm_similarity": 0.9849249124526978,
      "predicted_l1_cosine_to_correct": 0.06381448358297348,
      "esm_weights": {
        "egfr": 0.08557698931150916,
        "drd2": 0.1300070798336584,
        "bace1": 0.08866974567098754,
        "esr1": 0.11726820885302942,
        "hdac2": 0.11389910016971729,
        "jak2": 0.12024937849392019,
        "pparg": 0.11878368725836186,
        "cyp3a4": 0.10658599658485615,
        "fxa": 0.11895981382395994
      }
    },
    "bace1": {
      "auc_generic": 0.7627423778046969,
      "auc_esm_nn": 0.7094836760801092,
      "auc_esm_weighted": 0.6894835855535445,
      "auc_correct": 0.6575414569232171,
      "nearest_esm_target": "egfr",
      "nearest_esm_similarity": 0.896173894405365,
      "predicted_l1_cosine_to_correct": 0.04619504511356354,
      "esm_weights": {
        "egfr": 0.13190616776311442,
        "drd2": 0.10895542383564417,
        "adrb2": 0.10743894057209724,
        "esr1": 0.11411276882897729,
        "hdac2": 0.1050865539956094,
        "jak2": 0.10409489180116746,
        "pparg": 0.10443302877855203,
        "cyp3a4": 0.11249478224209893,
        "fxa": 0.11147744218273914
      }
    },
    "esr1": {
      "auc_generic": 0.7764895058456804,
      "auc_esm_nn": 0.6768751753443645,
      "auc_esm_weighted": 0.7550231803142998,
      "auc_correct": 0.9091118623115224,
      "nearest_esm_target": "pparg",
      "nearest_esm_similarity": 0.9835121035575867,
      "predicted_l1_cosine_to_correct": 0.053044144064188004,
      "esm_weights": {
        "egfr": 0.08836953697526079,
        "drd2": 0.11981223902204717,
        "adrb2": 0.11508873461726808,
        "bace1": 0.09242735224943781,
        "hdac2": 0.11836937198660698,
        "jak2": 0.12261854951672123,
        "pparg": 0.12723083473692415,
        "cyp3a4": 0.09700338462043412,
        "fxa": 0.11907999627529965
      }
    },
    "hdac2": {
      "auc_generic": 0.8241570697350906,
      "auc_esm_nn": 0.876084062797413,
      "auc_esm_weighted": 0.9110454426802557,
      "auc_correct": 0.9252797202230305,
      "nearest_esm_target": "jak2",
      "nearest_esm_similarity": 0.9695395231246948,
      "predicted_l1_cosine_to_correct": 0.07544703781604767,
      "esm_weights": {
        "egfr": 0.08937311527555841,
        "drd2": 0.11677806491797914,
        "adrb2": 0.11297163153511369,
        "bace1": 0.08602209282272522,
        "esr1": 0.11962885003878038,
        "jak2": 0.12504102696412736,
        "pparg": 0.12388321199483968,
        "cyp3a4": 0.10397196515015483,
        "fxa": 0.12233004130072145
      }
    },
    "jak2": {
      "auc_generic": 0.8575986590893312,
      "auc_esm_nn": 0.7256255764824899,
      "auc_esm_weighted": 0.8318367104049509,
      "auc_correct": 0.9045384668789114,
      "nearest_esm_target": "pparg",
      "nearest_esm_similarity": 0.9823476672172546,
      "predicted_l1_cosine_to_correct": 0.01977245882153511,
      "esm_weights": {
        "egfr": 0.08337494942078519,
        "drd2": 0.12004695895935899,
        "adrb2": 0.11751808207943198,
        "bace1": 0.08395856716883213,
        "esr1": 0.12210276703389836,
        "hdac2": 0.12320413351994854,
        "pparg": 0.12640093641350292,
        "cyp3a4": 0.10134465379722435,
        "fxa": 0.12204895160701751
      }
    },
    "pparg": {
      "auc_generic": 0.7648831208914889,
      "auc_esm_nn": 0.7681382203994437,
      "auc_esm_weighted": 0.7147975858983404,
      "auc_correct": 0.8352107879325716,
      "nearest_esm_target": "esr1",
      "nearest_esm_similarity": 0.9835121035575867,
      "predicted_l1_cosine_to_correct": -0.049319494515657425,
      "esm_weights": {
        "egfr": 0.08237129302157802,
        "drd2": 0.12044922363566647,
        "adrb2": 0.11627764683183349,
        "bace1": 0.0843705831668763,
        "esr1": 0.12690516116124326,
        "hdac2": 0.12226517701331469,
        "jak2": 0.12660995907583822,
        "cyp3a4": 0.09953925323051589,
        "fxa": 0.12121170286313368
      }
    },
    "cyp3a4": {
      "auc_generic": 0.6411079548016485,
      "auc_esm_nn": 0.7983639495351206,
      "auc_esm_weighted": 0.8064527590653716,
      "auc_correct": 0.6832009486964442,
      "nearest_esm_target": "adrb2",
      "nearest_esm_similarity": 0.8856065273284912,
      "predicted_l1_cosine_to_correct": -0.1458117961883545,
      "esm_weights": {
        "egfr": 0.10880648118576129,
        "drd2": 0.11473796741447145,
        "adrb2": 0.11577112309463052,
        "bace1": 0.10084310774058948,
        "esr1": 0.10735801196849058,
        "hdac2": 0.11385896741961082,
        "jak2": 0.11263648390786446,
        "pparg": 0.11044728451657569,
        "fxa": 0.11554057275200576
      }
    },
    "fxa": {
      "auc_generic": 0.8309396793334175,
      "auc_esm_nn": 0.8175970710768842,
      "auc_esm_weighted": 0.8492439338467366,
      "auc_correct": 0.8502314354248202,
      "nearest_esm_target": "jak2",
      "nearest_esm_similarity": 0.9648293256759644,
      "predicted_l1_cosine_to_correct": 0.04766961187124252,
      "esm_weights": {
        "egfr": 0.0899343766051812,
        "drd2": 0.11827320149871426,
        "adrb2": 0.11618317442660721,
        "bace1": 0.08985530103353982,
        "esr1": 0.11850297452612021,
        "hdac2": 0.1204555949656834,
        "jak2": 0.12197060024540309,
        "pparg": 0.12093390686775102,
        "cyp3a4": 0.1038908698309999
      }
    }
  },
  "embedding_stats": {
    "egfr": {
      "esm_norm": 5.123513698577881,
      "l1_norm": 0.45160913467407227,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "drd2": {
      "esm_norm": 6.311331748962402,
      "l1_norm": 0.4919999837875366,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "adrb2": {
      "esm_norm": 6.301490306854248,
      "l1_norm": 0.4985921382904053,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "bace1": {
      "esm_norm": 5.510529041290283,
      "l1_norm": 0.5868380665779114,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "esr1": {
      "esm_norm": 7.903848648071289,
      "l1_norm": 0.5269460082054138,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "hdac2": {
      "esm_norm": 7.284733772277832,
      "l1_norm": 0.4488863945007324,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "jak2": {
      "esm_norm": 7.609241962432861,
      "l1_norm": 0.5139339566230774,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "pparg": {
      "esm_norm": 8.216079711914062,
      "l1_norm": 0.4793744683265686,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "cyp3a4": {
      "esm_norm": 5.33150577545166,
      "l1_norm": 0.6963547468185425,
      "esm_dim": 1280,
      "l1_dim": 128
    },
    "fxa": {
      "esm_norm": 6.755972385406494,
      "l1_norm": 0.5077611207962036,
      "esm_dim": 1280,
      "l1_dim": 128
    }
  }
}